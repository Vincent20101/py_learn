import msgpack
import array, socket

# 获取 key 中的数据
# packed_data = b'\xde\x00\x12\xa8BitFlags\xcf\x00\x00\x00\x00\x00\x00\x00\x17\xa9DefPsaUpf\xde\x00\x13\xaaInstanceId\xd9$2994b3a0-5ac3-4cb5-bdf9-03d5f3516866\xaaUpfInfoKey\xa219\xa7UpfType\xcc\x01\xa6SessIp\x81\xa8Ipv4Addr\xc4\x04\xa7\x0c\x0f\"\xa8IpPoolV4\xd9QIPv4-SmfIpPool-<2994b3a0-5ac3-4cb5-bdf9-03d5f3516866>-<19>-<ims41>-ims-<1-000007>\xadSmfIpPoolInfo\x8a\xaaUpfInfoKey\xa219\xa3Dnn\xa3ims\xa6Snssai\x82\xa3Sst\xd2\x00\x00\x00\x01\xa2Sd\xa6000007\xacCgNatProfile\xa0\xaeIpamV4PoolName\xd9QIPv4-SmfIpPool-<2994b3a0-5ac3-4cb5-bdf9-03d5f3516866>-<19>-<ims41>-ims-<1-000007>\xaeIpamV6PoolName\xa0\xafV4StickinessTtl\xce\x00\x01Q\x80\xafV6StickinessTtl\xce\x00\x00\x00\x00\xb0V4HardStickiness\xc2\xb0V6HardStickiness\xc2\xa6LFseid\x85\xa2V4\xc2\xa2V6\xc3\xa4Seid\xcf\x00\x00\x00\x00\x00<)!\xabIpv4Address\xc0\xabIpv6Address\xc4\x10\x00\x11\x00 \x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x12\xa6RFseid\x85\xa2V4\xc2\xa2V6\xc3\xa4Seid\xcf\x00\x00\x00\x13P\xf8B`\xabIpv4Address\xc0\xabIpv6Address\xc4\x10\x00\x11\x00 \x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\xa6N4Port\xd2\x00\x00\"e\xa8GnbFteid\x82\xaaAccessType\xcc\x01\xa5Fteid\xc4\t\x01\x00\x03\x0b\xe6\n\x80\a;\xa7N3Fteid\xc4\x19\x03P\xf8B`\x0b\x14\x01b\x00\x11\x00 \x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x98\xa7DefFlow\x82\xa8QerULDef\xce\x7f\xff\xff\xff\xa8QerDLDef\xce\x7f\xff\xff\xfe\xadDedicatedFlow\x95\x8f\xa9QosRuleId\xcc\x01\xa5PdrUL\xce\x00\x00@\x01\xa5PdrDL\xce\x00\x00@\x02\xa5FarUL\xce@\x00\x00\x01\xa5FarDL\xce@\x00\x00\x02\xa5QerUL\xce@\x00\x00\x01\xa5QerDL\xce@\x00\x00\x02\xa8QerULDef\xce\x7f\xff\xff\xff\xa8QerDLDef\xce\x7f\xff\xff\xfe\xa7ChgUrrs\x92\xce@\x00\x00\x01\xce@\x00\x00\b\xadPrimaryChgUrr\xce@\x00\x00\b\xaaPrecedence\xce\x00\x00\x03\xc0\xa3Qfi\xcc\b\xa9PccRuleId\xaaAPPLE-PUSH\xafPccRuleBaseName\xb3pcc_rulebase_static\x8f\xa9QosRuleId\xcc\x02\xa5PdrUL\xce\x00\x00@\x03\xa5PdrDL\xce\x00\x00@\x04\xa5FarUL\xce@\x00\x00\x03\xa5FarDL\xce@\x00\x00\x04\xa5QerUL\xce@\x00\x00\x03\xa5QerDL\xce@\x00\x00\x04\xa8QerULDef\xce\x7f\xff\xff\xff\xa8QerDLDef\xce\x7f\xff\xff\xfe\xa7ChgUrrs\x93\xce@\x00\x00\x01\xce@\x00\x00\t\xce@\x00\x00\x11\xadPrimaryChgUrr\xce@\x00\x00\x11\xaaPrecedence\xce\x00\x00Q\"\xa3Qfi\xcc\b\xa9PccRuleId\xa7IP-PKTS\xafPccRuleBaseName\xb3pcc_rulebase_static\x8f\xa9QosRuleId\xcc\x03\xa5PdrUL\xce\x00\x00@\x05\xa5PdrDL\xce\x00\x00@\x06\xa5FarUL\xce@\x00\x00\x05\xa5FarDL\xce@\x00\x00\x06\xa5QerUL\xce@\x00\x00\x05\xa5QerDL\xce@\x00\x00\x06\xa8QerULDef\xce\x7f\xff\xff\xff\xa8QerDLDef\xce\x7f\xff\xff\xfe\xa7ChgUrrs\x93\xce@\x00\x00\x01\xce@\x00\x00\t\xce@\x00\x00\x19\xadPrimaryChgUrr\xce@\x00\x00\x19\xaaPrecedence\xce\x00\x00\x03h\xa3Qfi\xcc\b\xa9PccRuleId\xb7MMSC-SERVER-DOMAIN-DROP\xafPccRuleBaseName\xb3pcc_rulebase_static\x8e\xa9QosRuleId\xcc\x04\xa5PdrUL\xce\x00\x00@\a\xa5PdrDL\xce\x00\x00@\b\xa5FarUL\xce@\x00\x00\a\xa5FarDL\xce@\x00\x00\b\xa5QerUL\xce@\x00\x00\a\xa5QerDL\xce@\x00\x00\b\xa8QerULDef\xce\x7f\xff\xff\xff\xa8QerDLDef\xce\x7f\xff\xff\xfe\xa7ChgUrrs\x92\xce@\x00\x00\x01\xce@\x00\x00\b\xadPrimaryChgUrr\xce@\x00\x00\b\xaaPrecedence\xce\x00\x00\nn\xa3Qfi\xcc\b\xa9PccRuleId\xabPCC-Default\x85\xa9QosRuleId\xcc\x05\xa7ChgUrrs\x92\xce@\x00\x00\x01\xce@\x00\x00\b\xadPrimaryChgUrr\xce@\x00\x00\b\xa3Qfi\xcc\t\xa9PccRuleId\xabVIDEO-OPT-1\xa6NextId\x85\xa3Pdr\xce\x00\x00\x00\b\xa3Far\xce\x00\x00\x00\b\xa3Qer\xce\x00\x00\x00\b\xa6AdcUrr\xce\x00\x00\x00\x02\xa3Bar\xce\x00\x00\x00\t\xaeN3IntfAddrType\xa6IPV4V6\xb1SupportedFeatures\xcf\x00\x00\x00\x00\x00\x01M\xf0\xadTcOffloadInfo\x80\xa5EstTs\xd3\x00\x00\x00\x00g(k\xb3\xabUrllcUpfRsc\x80\xa6PcfRef\xa74038214\xa6ChfRef\xa74033859\xb7RoutingIndicatorFromAmf\xa44567\xaePcfReqTriggers\xcf\x00\x00\x00\x00\x00DP\r\xabPcfSuppFeat\xa40200\xbeDefaultChargingCharacteristics\xa40C00\xa4Ciot\x80\xaaTimeEvents\x82\xadSessStartTime\xd7\xff\t\xf3c0g(k\xb3\xacSessStopTime\xd7\xff\x95^%0g(n\xb4\xb5LastActivityTimestamp\xd7\xffs\xa8U`g(\x89\xb8\xabIdleTimeout\xce\x00\x01Q\x80\xa6UeType\xa4HOME\xb2SessConnCountDbKey\xd9|KPI-PDU-SESS,STATUS:actve,NFSETID:setxyzabc.smfset.5gc.mnc480.mcc311,DNN:ims,RAT:NR,SESSTYPE:HOME,SST:1,SD:000007,SESSION:5G\xb0NfSessCountDbKey\x85\xafPcfSessCountKey\xd94KPI-NF-SESS,PCF,f02b01eb-7c94-4102-8387-df9b4fcdc125\xafUdmSessCountKey\xd94KPI-NF-SESS,UDM,f02b01eb-7c94-4102-8387-df9b4fcdc124\xafChfSessCountKey\xd94KPI-NF-SESS,CHF,f02b01eb-7c94-4102-8387-df9b4fcdc126\xafAmfSessCountKey\xd94KPI-NF-SESS,AMF,81234561-5aaa-4ffd-98aa-7624672cba66\xb2UpfSessCountKeySet\x81\xd94KPI-NF-SESS,UPF,2994b3a0-5ac3-4cb5-bdf9-03d5f3516866\x80\xb5SubsequentInformation\x81\xa7Binding\x80\xa6NfInfo\x89\xa9AmfCommEp\x83\xa7Version\x82\xafApiVersionInUri\xa2v1\xaeApiFullVersion\xa51.0.0\xa8Hostport\xd9\"http://testersr66.tool-tester:8084\xacNfInstanceId\xd9$81234561-5aaa-4ffd-98aa-7624672cba66\xa9AmfEvtsEp\x81\xa7Version\x82\xafApiVersionInUri\xa0\xaeApiFullVersion\xa0\xa7AmfMtEp\x81\xa7Version\x82\xafApiVersionInUri\xa0\xaeApiFullVersion\xa0\xb1AmfNotificationEp\x81\xa7Version\x82\xafApiVersionInUri\xa0\xaeApiFullVersion\xa0\xa9UdmUecmEp\x83\xa7Version\x82\xafApiVersionInUri\xa2v1\xaeApiFullVersion\xa51.0.2\xa8Hostport\xb3http://sim-udm-1:80\xacNfInstanceId\xd9$f02b01eb-7c94-4102-8387-df9b4fcdc124\xa8UdmSdmEp\x83\xa7Version\x82\xafApiVersionInUri\xa2v2\xaeApiFullVersion\xa52.0.1\xa8Hostport\xb3http://sim-udm-1:80\xacNfInstanceId\xd9$f02b01eb-7c94-4102-8387-df9b4fcdc124\xa5PcfEp\x83\xa7Version\x82\xafApiVersionInUri\xa2v1\xaeApiFullVersion\xa51.0.2\xa8Hostport\xb3http://sim-pcf-1:80\xacNfInstanceId\xd9$f02b01eb-7c94-4102-8387-df9b4fcdc125\xa5ChfEp\x83\xa7Version\x82\xafApiVersionInUri\xa2v2\xaeApiFullVersion\xa51.0.0\xa8Hostport\xb3http://sim-chf-1:80\xacNfInstanceId\xd9$f02b01eb-7c94-4102-8387-df9b4fcdc126\xa5NefEp\x81\xa7Version\x82\xafApiVersionInUri\xa0\xaeApiFullVersion\xa0\xa9UrllcInfo\x80'
# packed_data = b'\xde\x00\x13\xa8BitFlags\xcf\x00\x00\x00\x00\x00\x00\x00\x17\xa9DefPsaUpf\xde\x00\x11\xaaInstanceId\xd9$2994b3a0-5ac3-4cb5-bdf9-03d5f3516866\xaaUpfInfoKey\xa19\xa7UpfType\xcc\x01\xa6SessIp\x81\xa8Ipv6Addr\x82\xa2IP\xc4\x10\x01W\x00\x00\x00\x14\b\xe0\x00\x00\x00\x00\x00\x00\x00\x00\xa4Mask\xc4\x10\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xa8IpPoolV6\xd9aIPv6-SmfIpPool-<2994b3a0-5ac3-4cb5-bdf9-03d5f3516866>-<9>-<v5ga01int61>-v5ga01internet-<1-000007>\xadSmfIpPoolInfo\x8a\xaaUpfInfoKey\xa19\xa3Dnn\xaev5ga01internet\xa6Snssai\x82\xa3Sst\xd2\x00\x00\x00\x01\xa2Sd\xa6000007\xacCgNatProfile\xa0\xaeIpamV4PoolName\xa0\xaeIpamV6PoolName\xd9aIPv6-SmfIpPool-<2994b3a0-5ac3-4cb5-bdf9-03d5f3516866>-<9>-<v5ga01int61>-v5ga01internet-<1-000007>\xafV4StickinessTtl\xce\x00\x00\x00\x00\xafV6StickinessTtl\xce\x00\x00\x01,\xb0V4HardStickiness\xc2\xb0V6HardStickiness\xc2\xa6LFseid\x85\xa2V4\xc2\xa2V6\xc3\xa4Seid\xcf\x00\x00\x00\x00\x00/\x92\xe0\xabIpv4Address\xc0\xabIpv6Address\xc4\x10\x00\x11\x00 \x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x12\xa6RFseid\x85\xa2V4\xc2\xa2V6\xc3\xa4Seid\xcf\x00\x00\x00\t\'\x83\x81 \xabIpv4Address\xc0\xabIpv6Address\xc4\x10\x00\x11\x00 \x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\xa6N4Port\xd2\x00\x00\"e\xa7DefFlow\x82\xa8QerULDef\xce\x7f\xff\xff\xff\xa8QerDLDef\xce\x7f\xff\xff\xfe\xadDedicatedFlow\x94\xde\x00\x10\xa9QosRuleId\xcc\x01\xa5PdrUL\xce\x00\x00@\x01\xa5PdrDL\xce\x00\x00@\x02\xa5FarUL\xce@\x00\x00\x01\xa5FarDL\xce@\x00\x00\x02\xa5QerUL\xce@\x00\x00\x01\xa5QerDL\xce@\x00\x00\x02\xa8QerULDef\xce\x7f\xff\xff\xff\xa8QerDLDef\xce\x7f\xff\xff\xfe\xa7ChgUrrs\x92\xce@\x00\x00\x01\xce@\x00\x00\b\xadPrimaryChgUrr\xce@\x00\x00\b\xaaPrecedence\xce\x00\x00\x03\xc0\xa3Qfi\xcc\b\xa3Ebi\xcc\x05\xa9PccRuleId\xaaAPPLE-PUSH\xafPccRuleBaseName\xb3pcc_rulebase_static\xde\x00\x10\xa9QosRuleId\xcc\x02\xa5PdrUL\xce\x00\x00@\x03\xa5PdrDL\xce\x00\x00@\x04\xa5FarUL\xce@\x00\x00\x03\xa5FarDL\xce@\x00\x00\x04\xa5QerUL\xce@\x00\x00\x03\xa5QerDL\xce@\x00\x00\x04\xa8QerULDef\xce\x7f\xff\xff\xff\xa8QerDLDef\xce\x7f\xff\xff\xfe\xa7ChgUrrs\x93\xce@\x00\x00\x01\xce@\x00\x00\t\xce@\x00\x00\x11\xadPrimaryChgUrr\xce@\x00\x00\x11\xaaPrecedence\xce\x00\x00Q\"\xa3Qfi\xcc\b\xa3Ebi\xcc\x05\xa9PccRuleId\xa7IP-PKTS\xafPccRuleBaseName\xb3pcc_rulebase_static\xde\x00\x10\xa9QosRuleId\xcc\x03\xa5PdrUL\xce\x00\x00@\x05\xa5PdrDL\xce\x00\x00@\x06\xa5FarUL\xce@\x00\x00\x05\xa5FarDL\xce@\x00\x00\x06\xa5QerUL\xce@\x00\x00\x05\xa5QerDL\xce@\x00\x00\x06\xa8QerULDef\xce\x7f\xff\xff\xff\xa8QerDLDef\xce\x7f\xff\xff\xfe\xa7ChgUrrs\x93\xce@\x00\x00\x01\xce@\x00\x00\t\xce@\x00\x00\x19\xadPrimaryChgUrr\xce@\x00\x00\x19\xaaPrecedence\xce\x00\x00\x03h\xa3Qfi\xcc\b\xa3Ebi\xcc\x05\xa9PccRuleId\xb7MMSC-SERVER-DOMAIN-DROP\xafPccRuleBaseName\xb3pcc_rulebase_static\x8f\xa9QosRuleId\xcc\x04\xa5PdrUL\xce\x00\x00@\a\xa5PdrDL\xce\x00\x00@\b\xa5FarUL\xce@\x00\x00\a\xa5FarDL\xce@\x00\x00\b\xa5QerUL\xce@\x00\x00\a\xa5QerDL\xce@\x00\x00\b\xa8QerULDef\xce\x7f\xff\xff\xff\xa8QerDLDef\xce\x7f\xff\xff\xfe\xa7ChgUrrs\x92\xce@\x00\x00\x01\xce@\x00\x00\b\xadPrimaryChgUrr\xce@\x00\x00\b\xaaPrecedence\xce\x00\x00\nn\xa3Qfi\xcc\b\xa3Ebi\xcc\x05\xa9PccRuleId\xabPCC-Default\xa6NextId\x84\xa3Pdr\xce\x00\x00\x00\b\xa3Far\xce\x00\x00\x00\b\xa3Qer\xce\x00\x00\x00\b\xa6AdcUrr\xce\x00\x00\x00\x02\xaeN3IntfAddrType\xa6IPV4V6\xb1SupportedFeatures\xcf\x00\x00\x00\x00\x00\x01M\xf0\xadTcOffloadInfo\x80\xa5EstTs\xd3\x00\x00\x00\x00g(1\xe7\xabUrllcUpfRsc\x80\xa7SmfTeid\xce\x00\t\xc2\a\xa6PcfRef\xa73245589\xa6ChfRef\xa73245416\xaePcfReqTriggers\xcf\x00\x00\x00\x00\x00DP\r\xabPcfSuppFeat\xa40200\xbeDefaultChargingCharacteristics\xa40C00\xa4Ciot\x80\xaaTimeEvents\x81\xadSessStartTime\xd7\xffd/\xfbdg(1\xe7\xb4OriginationTimestamp\xd9!Mon, 04 Nov 2024 02:31:03.420 GMT\xb5LastActivityTimestamp\xd7\xff\xe9\x96\x87\bg(\x8b\xd0\xabIdleTimeout\xce\x00\x01Q\x80\xa6UeType\xa4HOME\xb2SessConnCountDbKey\xd9\x8aKPI-PDU-SESS,STATUS:actve,NFSETID:setxyzabc.smfset.5gc.mnc480.mcc311,DNN:v5ga01internet,RAT:EUTRA,SESSTYPE:HOME,SST:1,SD:000007,SESSION:4G\xb0NfSessCountDbKey\x84\xafPcfSessCountKey\xd94KPI-NF-SESS,PCF,f02b01eb-7c94-4102-8387-df9b4fcdc125\xafUdmSessCountKey\xd94KPI-NF-SESS,UDM,f02b01eb-7c94-4102-8387-df9b4fcdc124\xafChfSessCountKey\xd94KPI-NF-SESS,CHF,f02b01eb-7c94-4102-8387-df9b4fcdc126\xb2UpfSessCountKeySet\x81\xd94KPI-NF-SESS,UPF,2994b3a0-5ac3-4cb5-bdf9-03d5f3516866\x80\xb5SubsequentInformation\x81\xa7Binding\x80\xa6NfInfo\x89\xa9AmfCommEp\x81\xa7Version\x82\xafApiVersionInUri\xa0\xaeApiFullVersion\xa0\xa9AmfEvtsEp\x81\xa7Version\x82\xafApiVersionInUri\xa0\xaeApiFullVersion\xa0\xa7AmfMtEp\x81\xa7Version\x82\xafApiVersionInUri\xa0\xaeApiFullVersion\xa0\xb1AmfNotificationEp\x81\xa7Version\x82\xafApiVersionInUri\xa0\xaeApiFullVersion\xa0\xa9UdmUecmEp\x83\xa7Version\x82\xafApiVersionInUri\xa2v1\xaeApiFullVersion\xa51.0.2\xa8Hostport\xb3http://sim-udm-1:80\xacNfInstanceId\xd9$f02b01eb-7c94-4102-8387-df9b4fcdc124\xa8UdmSdmEp\x83\xa7Version\x82\xafApiVersionInUri\xa2v2\xaeApiFullVersion\xa52.0.1\xa8Hostport\xb3http://sim-udm-1:80\xacNfInstanceId\xd9$f02b01eb-7c94-4102-8387-df9b4fcdc124\xa5PcfEp\x83\xa7Version\x82\xafApiVersionInUri\xa2v1\xaeApiFullVersion\xa51.0.2\xa8Hostport\xb3http://sim-pcf-1:80\xacNfInstanceId\xd9$f02b01eb-7c94-4102-8387-df9b4fcdc125\xa5ChfEp\x83\xa7Version\x82\xafApiVersionInUri\xa2v2\xaeApiFullVersion\xa51.0.0\xa8Hostport\xb3http://sim-chf-1:80\xacNfInstanceId\xd9$f02b01eb-7c94-4102-8387-df9b4fcdc126\xa5NefEp\x81\xa7Version\x82\xafApiVersionInUri\xa0\xaeApiFullVersion\xa0\xa9UrllcInfo\x80'
# packed_data = b'\x84\xa4Supi\xb4imsi-311480000120509\xa3Pei\xb7imeisv-8600100312050900\xa4Gpsi\xb5msisdn-12345000120509\xadIsUEReachable\xc3'
packed_data = b'hKRQcm9mgqlOZlByb2ZpbGXeABqsTmZJbnN0YW5jZUlk2SQ3Yzk4ODkyYy00MGEzLTExZWItYjM3OC0wMjQyYWMxMzAwMDCmTmZUeXBlo0FNRqhOZlN0YXR1c6pSRUdJU1RFUkVErk5mSW5zdGFuY2VOYW1lpGFtZjGoUGxtbkxpc3TAp1NOc3NhaXPAsVBlclBsbW5TbnNzYWlMaXN0wKdOc2lMaXN0wKRGcWRus3NtZjEtc21mdGVzdGVyOjcwMDCtSW50ZXJQbG1uRnFkbqCtSXB2NEFkZHJlc3Nlc8CtSXB2NkFkZHJlc3Nlc8CsQWxsb3dlZFBsbW5zwK5BbGxvd2VkTmZUeXBlc8CwQWxsb3dlZE5mRG9tYWluc8CtQWxsb3dlZE5zc2Fpc8CoUHJpb3JpdHnSAAD//6hDYXBhY2l0ecCkTG9hZMCoTG9jYWxpdHmgqkN1c3RvbUluZm/AtE5mU2VydmljZVBlcnNpc3RlbmNlwqpOZlNlcnZpY2Vzko6xU2VydmljZUluc3RhbmNlSWTZLTdjOTg4OTJjLTQwYTMtMTFlYi1iMzc4LTAyNDJhYzEzMDAwMF9uYW1mLWNvbatTZXJ2aWNlTmFtZaluYW1mLWNvbW2oVmVyc2lvbnORg69BcGlWZXJzaW9uSW5VcmmidjGuQXBpRnVsbFZlcnNpb26lMS4wLjC3VXNlZFByZWZlcnJlZEFwaVZlcnNpb26gplNjaGVtZaRodHRwpEZxZG6gq0lwRW5kUG9pbnRzwKlBcGlQcmVmaXigqENhcGFjaXR5wKRMb2FkwKhQcmlvcml0ecCuQ2hmU2VydmljZUluZm/AsVN1cHBvcnRlZEZlYXR1cmVzoLJOZlNlcnZpY2VTZXRJZExpc3TArk9hdXRoMlJlcXVpcmVkwI6xU2VydmljZUluc3RhbmNlSWTZLjdjOTg4OTJjLTQwYTMtMTFlYi1iMzc4LTAyNDJhYzEzMDAwMF9uYW1mLWV2dHOrU2VydmljZU5hbWWpbmFtZi1ldnRzqFZlcnNpb25zkYOvQXBpVmVyc2lvbkluVXJponYxrkFwaUZ1bGxWZXJzaW9upTEuMC4wt1VzZWRQcmVmZXJyZWRBcGlWZXJzaW9uoKZTY2hlbWWkaHR0cKRGcWRuoKtJcEVuZFBvaW50c8CpQXBpUHJlZml4oKhDYXBhY2l0ecCkTG9hZMCoUHJpb3JpdHnArkNoZlNlcnZpY2VJbmZvwLFTdXBwb3J0ZWRGZWF0dXJlc6CyTmZTZXJ2aWNlU2V0SWRMaXN0wK5PYXV0aDJSZXF1aXJlZMCrTmZTZXRJZExpc3TAplQzQWRkcqCmRXhwaXJl0wAAAABnbSxAp0FtZkluZm+IqEFtZlNldElkoKtBbWZSZWdpb25JZKCpR3VhbWlMaXN0kYKmUGxtbklkgqNNY2OjMzExo01uY6M0ODClQW1mSWSmMDIwMEIyp1RhaUxpc3TArFRhaVJhbmdlTGlzdMC0QmFja3VwSW5mb0FtZkZhaWx1cmXAtEJhY2t1cEluZm9BbWZSZW1vdmFswLJOMkludGVyZmFjZUFtZkluZm/ApVRva2VuwK1TdWJzY3JpYmVJbmZvwKpTdGF0dXNJbmZvwA=='
# 反序列化数据
if packed_data is not None:
    data = msgpack.unpackb(packed_data, raw=False)
    print(data)
    # for k,v in data.items():
    #     print(k, v)
    # IPV4
    # ipv4 = data['DefPsaUpf']['SessIp']['Ipv4Addr']
    # print(ipv4)
    # print(socket.inet_ntoa(ipv4))
    # array_obj = array.array('b')
    # array_obj.frombytes(ipv4)
    # print(array_obj)

    #IPV6
    # ipv6 = data['DefPsaUpf']['SessIp']['Ipv6Addr']['IP']
    # print(ipv6)
    # ipv6_str = socket.inet_ntop(socket.AF_INET6, ipv6)
    # print(ipv6_str)
    # array_obj = array.array('b')
    # array_obj.frombytes(ipv6)
    # print(array_obj)
else:
    print("Key not found or no data.")

# ip_data = b'\x00\x11\x00 \x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04'
# print(str(ip_data,'utf-8'))
# ip_data.decode('utf-8')
